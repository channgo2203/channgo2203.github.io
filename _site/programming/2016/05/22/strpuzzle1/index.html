<!DOCTYPE html>
<html>

    <head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Shortest Substring Contains a List of Strings</title>
<meta name="description" content="Ngo's personal page and notes on programming">

<link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css">
<link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" media="all" href="/css/style.css" />
<link rel="stylesheet" type="text/css" media="all" href="/css/jquery.mmenu.all.css" />
<link rel="stylesheet" href="/css/highlightjs.piperita.css">

<!-- Favicons generated at http://realfavicongenerator.net/ -->
<link rel="apple-touch-icon" sizes="57x57" href="/favicons/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/favicons/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/favicons/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon-180x180.png">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-chrome-192x192.png" sizes="192x192">
<link rel="icon" type="image/png" href="/favicons/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="/favicons/manifest.json">
<link rel="shortcut icon" href="/favicons/favicon.ico">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-TileImage" content="/favicons/mstile-144x144.png">
<meta name="msapplication-config" content="/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">




<!-- MathJax for LaTeX -->
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


</head>


    <body>

    <nav id="my-menu">
  <div>
    <p>Van Chan Ngo</p>

    <ul class="pages">
      <li><a href="/"><i class="fa fa-home"></i> Home</a></li>
      <li><a href="/posts/"><i class="fa fa-archive"></i> All Articles</a></li>
      <li><a href="/research/"><i class="fa fa-archive"></i> Research</a></li>
      <li><a href="/pubs/"><i class="fa fa-archive"></i> Publications</a></li>
      <li><a href="/talks/"><i class="fa fa-archive"></i> Talks</a></li>
      <li><a href="/about/"><i class="fa fa-archive"></i> About</a></li>
      <li><a href="/search/"><i class="fa fa-search"></i> Search</a></li>
    </ul>

    <p class="links">
  <a href="https://www.twitter.com/channgo2203" target="_new"><i class="fa fa-twitter"></i></a>
  <a href="https://www.linkedin.com/in/channgo2203" target="_new"><i class="fa fa-linkedin"></i></a>
  
  
  
  <a href="https://github.com/channgo2203" target="_new"><i class="fa fa-github-alt"></i></a>
  
  
  
  <a href="/feed.xml" target="_new"><i class="fa fa-rss"></i></a>
</p>

  </div>
</nav>
<div class="menu-button" href="#menu"><i class="fa fa-bars"></i></div>


    <div class="page-content">
      <div class="wrap">
      

<div class="container-fluid single">
  <div class="row">

    <div itemscope itemtype="http://schema.org/Article" class="col-md-12 article">
      
      <div class="thumb">
        <i class="fa fa-cogs fa-4x"></i>
      </div>
      

      <h1 class="header" itemprop="name">Shortest Substring Contains a List of Strings</h1>
		
      <!--<div class="author">
        <small><i>
          
          on <span itemprop="datePublished" content="2014-08-28">May 22, 2016</span>
           under Programming
        </i></small>
      </div>
	  	
      <div class="read-time">
        <small>
          12 minute read
        </small>
      </div>-->

      <div class="content-panel content">

        

        <span itemprop="articleBody"><p>For example, given a string <code class="highlighter-rouge">str = “this is a test string this a”</code> and a string list 
<code class="highlighter-rouge">lstr = [“is”; "this"; "a"]</code>, then the output string is <code class="highlighter-rouge">“this a”</code>.</p>

<h3 id="simple-solution">Simple Solution</h3>

<ul>
  <li>Generate all substrings of str.</li>
  <li>For each substring, check that it contains all strings in lstr.</li>
  <li>Print out the smallest one.</li>
</ul>

<h3 id="complexity">Complexity</h3>

<p>The complexity depends on the number of substrings which is <script type="math/tex">O(n^2)</script>, where <code class="highlighter-rouge">n</code> is the 
length of str since the number of substring with the length <code class="highlighter-rouge">m</code> is <script type="math/tex">(n - m) + 1</script>. If 
finding each substring is <script type="math/tex">O(n)</script>. Then, the complexity is <script type="math/tex">O(n^3)</script>.</p>

<h3 id="efficient-solution">Efficient Solution</h3>

<ul>
  <li>Find the first occurence of a substring of str containing all strings in lstr.</li>
  <li>If there exists one, called substr, then store its length as the indices of its first 
and last characters in str in a list.</li>
  <li>Create a new string from str from the index of the character after the first character 
of substr,called str1. If it is empty, return the list. Otherwise find the first 
occurence of a substring of str1 that contains all strings in lstr. Compare its length 
with the store value in the list, if it is smaller or equal, then add the string 
indices in the list.</li>
  <li>Repeat the steps above.</li>
</ul>

<h3 id="complexity-1">Complexity</h3>

<p>The complexity is <script type="math/tex">nm</script> where <code class="highlighter-rouge">m</code> is number of substrings containing all strings in 
<code class="highlighter-rouge">lstr</code> such that its leftmost and rightmost substrings are strings in <code class="highlighter-rouge">lstr</code>, and <code class="highlighter-rouge">n</code> 
is the length of <code class="highlighter-rouge">str</code>. In the worst-case, it is <script type="math/tex">O(n^2)</script> when <code class="highlighter-rouge">str</code> is string of 
same characters and <code class="highlighter-rouge">lstr</code> is list of this single character strings.</p>

<p>In the following, I show how to implement the algorithm above in the functional 
language OCaml. All other utility functions can be downloaded <a href="https://github.com/channgo2203/puzzleset/tree/master/string/prob1">here</a>.</p>

<div class="language-ocaml highlighter-rouge"><pre class="highlight"><code><span class="c">(* 
 * find the shortest substring of str containing 
 * the strings str1 str2,...,strm in a list
 *)</span>

<span class="c">(* use core for more efficient with long strings *)</span>
<span class="k">open</span> <span class="nn">Core</span><span class="p">.</span><span class="nc">Std</span> 
<span class="k">open</span> <span class="nc">Printf</span>

<span class="c">(* 
 * find substring sub in string str forward from pos 
 *)</span>
<span class="k">let</span> <span class="n">find_sub</span> <span class="n">str</span> <span class="n">pos</span> <span class="n">sub</span> <span class="p">=</span> 
  <span class="k">let</span> <span class="n">r</span> <span class="p">=</span> <span class="nn">Str</span><span class="p">.</span><span class="n">regexp_string</span> <span class="n">sub</span> <span class="k">in</span>
  <span class="nn">Str</span><span class="p">.</span><span class="n">search_forward</span> <span class="n">r</span> <span class="n">str</span> <span class="n">pos</span> 

<span class="c">(* 
 * find substring sub in string str backward from pos 
 *)</span>
<span class="k">let</span> <span class="n">rfind_sub</span> <span class="n">str</span> <span class="n">pos</span> <span class="n">sub</span> <span class="p">=</span> 
  <span class="k">let</span> <span class="n">r</span> <span class="p">=</span> <span class="nn">Str</span><span class="p">.</span><span class="n">regexp_string</span> <span class="n">sub</span> <span class="k">in</span>
  <span class="nn">Str</span><span class="p">.</span><span class="n">search_backward</span> <span class="n">r</span> <span class="n">str</span> <span class="n">pos</span> 

<span class="c">(*
 * get the substring from findex to lindex inclding 
 * characters at findex and lindex
 *)</span>
<span class="k">let</span> <span class="n">get_substring</span> <span class="n">str</span> <span class="n">findex</span> <span class="n">lindex</span> <span class="p">=</span> 
  <span class="k">try</span> 
    <span class="k">let</span> <span class="n">sub</span> <span class="p">=</span> <span class="nn">String</span><span class="p">.</span><span class="n">sub</span> <span class="n">str</span> <span class="n">findex</span> <span class="p">(</span><span class="n">lindex</span> <span class="p">-</span> <span class="n">findex</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">in</span>
    <span class="nc">Some</span> <span class="n">sub</span>
  <span class="k">with</span> 
    <span class="nc">Invalid_argument</span> <span class="n">e</span> <span class="p">-&gt;</span> <span class="nc">None</span>

<span class="c">(*
 * min element in a list
 *)</span>
<span class="k">let</span> <span class="n">min_element</span> <span class="n">l</span> <span class="p">=</span> 
  <span class="k">let</span> <span class="n">h</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">hd</span> <span class="n">l</span> <span class="k">in</span>
  <span class="k">match</span> <span class="n">h</span> <span class="k">with</span>
  <span class="p">|</span> <span class="nc">None</span> <span class="p">-&gt;</span> <span class="p">-</span><span class="mi">1</span>
  <span class="p">|</span> <span class="nc">Some</span> <span class="n">i</span> <span class="p">-&gt;</span> 
      <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span> <span class="n">l</span> <span class="p">~</span><span class="n">init</span><span class="p">:</span><span class="n">i</span> 
        <span class="p">~</span><span class="n">f</span><span class="o">:(</span><span class="k">fun</span> <span class="n">a</span> <span class="n">b</span> <span class="p">-&gt;</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span> <span class="k">then</span> <span class="n">a</span> <span class="k">else</span> <span class="n">b</span><span class="p">)</span>

<span class="c">(*
 * max element in a list
 *)</span>
<span class="k">let</span> <span class="n">max_element</span> <span class="n">l</span> <span class="p">=</span> 
  <span class="k">let</span> <span class="n">h</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">hd</span> <span class="n">l</span> <span class="k">in</span> 
  <span class="k">match</span> <span class="n">h</span> <span class="k">with</span> 
  <span class="p">|</span> <span class="nc">None</span> <span class="p">-&gt;</span> <span class="p">-</span><span class="mi">1</span>
  <span class="p">|</span> <span class="nc">Some</span> <span class="n">i</span> <span class="p">-&gt;</span> <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span> <span class="n">l</span> <span class="p">~</span><span class="n">init</span><span class="p">:</span><span class="n">i</span> 
      <span class="p">~</span><span class="n">f</span><span class="o">:(</span><span class="k">fun</span> <span class="n">a</span> <span class="n">b</span> <span class="p">-&gt;</span> <span class="k">if</span> <span class="n">a</span> <span class="o">&gt;=</span> <span class="n">b</span> <span class="k">then</span> <span class="n">a</span> <span class="k">else</span> <span class="n">b</span><span class="p">)</span>

<span class="c">(* print all strings in the list of indices *)</span>
<span class="k">let</span> <span class="n">print_lstr_index</span> <span class="n">des</span> <span class="n">str</span> <span class="n">lindex</span> <span class="p">=</span> 
  <span class="n">printf</span> <span class="s2">"-------------------------------</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
  <span class="n">printf</span> <span class="s2">"%s</span><span class="se">\n</span><span class="s2">"</span> <span class="n">des</span><span class="p">;</span>
	
  <span class="k">let</span> <span class="n">lstr_opt</span> <span class="p">=</span> 
  <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="n">lindex</span> 
    <span class="p">(</span><span class="k">fun</span> <span class="n">x</span> <span class="p">-&gt;</span> 
     <span class="k">let</span> <span class="n">fi</span><span class="p">,</span><span class="n">li</span> <span class="p">=</span> <span class="n">x</span> <span class="k">in</span> 
     <span class="n">get_substring</span> <span class="n">str</span> <span class="n">fi</span> <span class="n">li</span><span class="p">)</span> 
  <span class="k">in</span> 
  <span class="nn">List</span><span class="p">.</span><span class="n">iter</span> <span class="n">lstr_opt</span> <span class="p">~</span><span class="n">f</span><span class="p">:</span> <span class="p">(</span><span class="k">fun</span> <span class="n">s_opt</span> <span class="p">-&gt;</span> 
    <span class="k">match</span> <span class="n">s_opt</span> <span class="k">with</span> 
    <span class="p">|</span> <span class="nc">None</span> <span class="p">-&gt;</span> <span class="n">printf</span> <span class="s2">"Invalid indices</span><span class="se">\n</span><span class="s2">"</span> 
    <span class="p">|</span> <span class="nc">Some</span> <span class="n">s</span> <span class="p">-&gt;</span> <span class="n">printf</span> <span class="s2">"%s</span><span class="se">\n</span><span class="s2">"</span> <span class="n">s</span><span class="o">);</span>
	
  <span class="n">printf</span> <span class="s2">"-------------------------------</span><span class="se">\n</span><span class="s2">"</span>

<span class="c">(* print all strings in a list *)</span>
<span class="k">let</span> <span class="n">print_lstr</span> <span class="n">des</span> <span class="n">lstr</span> <span class="p">=</span> 
  <span class="n">printf</span> <span class="s2">"-------------------------------</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
  <span class="n">printf</span> <span class="s2">"%s</span><span class="se">\n</span><span class="s2">"</span> <span class="n">des</span><span class="p">;</span>
	
  <span class="nn">List</span><span class="p">.</span><span class="n">iter</span> <span class="n">lstr</span> <span class="p">~</span><span class="n">f</span><span class="p">:</span> <span class="p">(</span><span class="k">fun</span> <span class="n">s</span> <span class="p">-&gt;</span> <span class="n">printf</span> <span class="s2">"%s</span><span class="se">\n</span><span class="s2">"</span> <span class="n">s</span><span class="o">);</span>
	
  <span class="n">printf</span> <span class="s2">"-------------------------------</span><span class="se">\n</span><span class="s2">"</span>

<span class="c">(* print a list of indices *)</span>
<span class="k">let</span> <span class="n">print_lindex</span> <span class="n">des</span> <span class="n">lindex</span> <span class="p">=</span> 
  <span class="n">printf</span> <span class="s2">"-------------------------------</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
  <span class="n">printf</span> <span class="s2">"%s</span><span class="se">\n</span><span class="s2">"</span> <span class="n">des</span><span class="p">;</span>
	
  <span class="nn">List</span><span class="p">.</span><span class="n">iter</span> <span class="n">lindex</span> <span class="p">~</span><span class="n">f</span><span class="p">:</span> 
    <span class="p">(</span><span class="k">fun</span> <span class="n">s</span> <span class="p">-&gt;</span> <span class="k">let</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="p">=</span> <span class="n">s</span> <span class="k">in</span> <span class="n">printf</span> <span class="s2">"(%i,%i)</span><span class="se">\n</span><span class="s2">"</span> <span class="n">x</span> <span class="n">y</span><span class="o">);</span>
	
  <span class="n">printf</span> <span class="s2">"-------------------------------</span><span class="se">\n</span><span class="s2">"</span>
	
<span class="c">(*
 * compare two pair of indices 
 *)</span>
<span class="k">let</span> <span class="n">index_compare</span> <span class="n">x</span> <span class="n">y</span> <span class="p">=</span> 
  <span class="k">let</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x2</span> <span class="p">=</span> <span class="n">x</span> <span class="k">in</span> 
  <span class="k">let</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span> <span class="p">=</span> <span class="n">y</span> <span class="k">in</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x1</span> <span class="p">=</span> <span class="n">y1</span> <span class="p">&amp;&amp;</span> <span class="n">x2</span> <span class="p">=</span> <span class="n">y2</span><span class="p">)</span> <span class="k">then</span> <span class="mi">0</span> 
  <span class="k">else</span> <span class="k">if</span> <span class="o">((</span><span class="n">x1</span> <span class="p">&lt;</span> <span class="n">y1</span><span class="p">)</span> <span class="o">||</span> <span class="p">(</span><span class="n">x1</span> <span class="p">=</span> <span class="n">y1</span> <span class="p">&amp;&amp;</span> <span class="n">x2</span> <span class="o">&lt;=</span> <span class="n">y2</span><span class="o">))</span> <span class="k">then</span> <span class="p">-</span><span class="mi">1</span> 
  <span class="k">else</span> <span class="mi">1</span>
 
<span class="c">(*
 * update the set shortest substrings
 * if new_sub is not longer, then add it to the set
 *)</span>
<span class="k">let</span> <span class="n">update_lshortest_substr</span> <span class="n">l</span> <span class="n">i</span> <span class="p">=</span> 
  <span class="k">let</span> <span class="n">a_opt</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">hd</span> <span class="n">l</span> <span class="k">in</span>
  <span class="k">match</span> <span class="n">a_opt</span> <span class="k">with</span>
  <span class="p">|</span> <span class="nc">None</span> <span class="p">-&gt;</span> <span class="p">[</span> <span class="n">i</span> <span class="p">]</span>
  <span class="p">|</span> <span class="nc">Some</span> <span class="n">a</span> <span class="p">-&gt;</span> 
    <span class="k">let</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span> <span class="p">=</span> <span class="n">i</span> <span class="k">in</span> 
    <span class="k">let</span> <span class="n">a1</span><span class="p">,</span> <span class="n">a2</span> <span class="p">=</span> <span class="n">a</span> <span class="k">in</span> 
    <span class="k">if</span> <span class="o">((</span><span class="n">i2</span> <span class="p">-</span> <span class="n">i1</span><span class="p">)</span> <span class="p">=</span> <span class="p">(</span><span class="n">a2</span> <span class="p">-</span> <span class="n">a1</span><span class="o">))</span> <span class="k">then</span>
      <span class="n">i</span> <span class="p">::</span> <span class="n">l</span>
    <span class="k">else</span> <span class="k">if</span> <span class="o">((</span><span class="n">i2</span> <span class="p">-</span> <span class="n">i1</span><span class="p">)</span> <span class="p">&lt;</span> <span class="p">(</span><span class="n">a2</span> <span class="p">-</span> <span class="n">a1</span><span class="o">))</span> <span class="k">then</span> 
      <span class="p">[</span> <span class="n">i</span> <span class="p">]</span>
    <span class="k">else</span> <span class="n">l</span>

<span class="c">(* 
 * find the first occurence of a substring in str 
 * that contains all strings in lstr
 * return the first and list indices of that substring
 * For example,
 * str = "This is a This string"
 * lstr = ["This"; "a"]
 * return = (0, 8)
 *)</span>
<span class="k">let</span> <span class="n">sub_lstr</span> <span class="n">str</span> <span class="n">lstr</span> <span class="p">=</span> 
  <span class="k">try</span> 
    <span class="k">let</span> <span class="n">length_list</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="n">lstr</span> <span class="p">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span><span class="p">)</span> <span class="k">in</span> 
    <span class="c">(* list of first occurence indices of all strings in lstr *)</span>
    <span class="k">let</span> <span class="n">findex_list</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="n">lstr</span> <span class="p">(</span><span class="n">find_sub</span> <span class="n">str</span> <span class="mi">0</span><span class="p">)</span> <span class="k">in</span> 
    <span class="c">(* return the first occurence of substring containing all strings in lstr *)</span>
    <span class="k">let</span> <span class="n">lindex_list</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">map2_exn</span> <span class="n">findex_list</span> <span class="n">length_list</span> <span class="o">(+)</span> <span class="k">in</span> 
    <span class="o">((</span><span class="n">min_element</span> <span class="n">findex_list</span><span class="o">),</span> <span class="o">((</span><span class="n">max_element</span> <span class="n">lindex_list</span><span class="p">)</span> <span class="p">-</span> <span class="mi">1</span><span class="o">))</span>					
  <span class="k">with</span> 
    <span class="p">|</span> <span class="nc">Invalid_argument</span> <span class="n">e</span> <span class="p">-&gt;</span> <span class="o">(-</span><span class="mi">1</span><span class="p">,</span> <span class="p">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">|</span> <span class="nc">Not_found</span> <span class="p">-&gt;</span> <span class="o">(-</span><span class="mi">1</span><span class="p">,</span> <span class="p">-</span><span class="mi">1</span><span class="p">)</span>

<span class="c">(* 
 * find the last occurence of a substring in str that 
 * contains all strings in lstr
 * return the first and list indices of that substring
 * For example,
 * str = "This is a This string"
 * lstr = ["This"; "a"]
 * return = (8, 13)
 *)</span>
<span class="k">let</span> <span class="n">rsub_lstr</span> <span class="n">str</span> <span class="n">lstr</span> <span class="p">=</span> 
  <span class="k">try</span> 
    <span class="k">let</span> <span class="n">length_list</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="n">lstr</span> <span class="p">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span><span class="p">)</span> <span class="k">in</span> 
    <span class="c">(* list of first occurence indices of all strings in lstr *)</span>
    <span class="k">let</span> <span class="n">findex_list</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">map</span> <span class="n">lstr</span> <span class="p">(</span><span class="n">rfind_sub</span> <span class="n">str</span> <span class="p">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="n">str</span> <span class="p">-</span> <span class="mi">1</span><span class="o">))</span> <span class="k">in</span> 
    <span class="c">(* return the last occurence of substring containing all strings in lstr *)</span>
    <span class="k">let</span> <span class="n">lindex_list</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">map2_exn</span> <span class="n">findex_list</span> <span class="n">length_list</span> <span class="o">(+)</span> <span class="k">in</span> 
    <span class="o">((</span><span class="n">min_element</span> <span class="n">findex_list</span><span class="o">),</span> <span class="o">((</span><span class="n">max_element</span> <span class="n">lindex_list</span><span class="p">)</span> <span class="p">-</span> <span class="mi">1</span><span class="o">))</span>					
  <span class="k">with</span> 
    <span class="p">|</span> <span class="nc">Invalid_argument</span> <span class="n">e</span> <span class="p">-&gt;</span> <span class="o">(-</span><span class="mi">1</span><span class="p">,</span> <span class="p">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">|</span> <span class="nc">Not_found</span> <span class="p">-&gt;</span> <span class="o">(-</span><span class="mi">1</span><span class="p">,</span> <span class="p">-</span><span class="mi">1</span><span class="p">)</span>


<span class="c">(*
 * find the shortest substring that containing all strings in the list
 * str : the string for searching
 * lstr : list of searching strings
 * n : the number of substrings containing all strings in lstr
 * lshortest_substr : return a list of (findex,lindex) indicate the locations of shortest substrings containing all strings in the lstr
 *)</span>
<span class="k">let</span> <span class="k">rec</span> <span class="n">find_shortest_substrings_aux</span> <span class="n">n</span> <span class="n">lshortest_substr</span> <span class="n">str</span> <span class="n">lstr</span> <span class="n">offset</span> <span class="p">=</span> 
  <span class="k">if</span> <span class="p">(</span><span class="nn">String</span><span class="p">.</span><span class="n">is_empty</span> <span class="n">str</span><span class="p">)</span> <span class="k">then</span>
    <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">lshortest_substr</span><span class="p">)</span>
  <span class="k">else</span>
    <span class="k">begin</span>
      <span class="c">(* find forward a substring containing the strings in lstr *)</span>
      <span class="k">let</span> <span class="n">substr_index</span> <span class="p">=</span> <span class="n">sub_lstr</span> <span class="n">str</span> <span class="n">lstr</span> <span class="k">in</span> 
      <span class="k">if</span> <span class="p">(</span><span class="n">substr_index</span> <span class="p">=</span> <span class="o">(-</span><span class="mi">1</span><span class="p">,</span> <span class="p">-</span><span class="mi">1</span><span class="o">))</span> <span class="k">then</span> 
        <span class="c">(* not found return the result *)</span>
        <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">lshortest_substr</span><span class="p">)</span>
      <span class="k">else</span> 
        <span class="c">(* updated lshortest_substr an find the next substring from fi + 1 to the end of str *)</span>
        <span class="k">let</span> <span class="n">fi</span><span class="p">,</span> <span class="n">li</span> <span class="p">=</span> <span class="n">substr_index</span> <span class="k">in</span> 
        <span class="n">find_shortest_substrings_aux</span> <span class="p">(</span><span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="n">update_lshortest_substr</span> <span class="n">lshortest_substr</span> <span class="p">(</span><span class="n">fi</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="n">li</span> <span class="o">+</span> <span class="n">offset</span><span class="o">))</span> <span class="p">(</span><span class="nn">String</span><span class="p">.</span><span class="n">sub</span> <span class="n">str</span> <span class="p">(</span><span class="n">fi</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="n">str</span> <span class="p">-</span> <span class="p">(</span><span class="n">fi</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)))</span> <span class="n">lstr</span> <span class="p">(</span><span class="n">offset</span> <span class="o">+</span> <span class="n">fi</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">end</span>

<span class="k">let</span> <span class="n">find_shortest_substrings</span> <span class="n">str</span> <span class="n">list_strings</span> <span class="p">=</span> 
  <span class="c">(* remove all empty strings in the lstr *)</span>
  <span class="k">let</span> <span class="n">lstr_tmp</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">filter</span> <span class="n">list_strings</span> <span class="p">(</span><span class="k">fun</span> <span class="n">x</span> <span class="p">-&gt;</span> <span class="n">not</span> <span class="p">(</span><span class="nn">String</span><span class="p">.</span><span class="n">is_empty</span> <span class="n">x</span><span class="o">))</span> <span class="k">in</span> 
  <span class="c">(* remove all duplicate strings in lstr_tmp *)</span>
  <span class="k">let</span> <span class="n">lstr</span> <span class="p">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">dedup</span> <span class="p">~</span><span class="n">compare</span><span class="o">:(</span><span class="n">compare</span><span class="p">)</span> <span class="n">lstr_tmp</span> <span class="k">in</span> 
  <span class="k">if</span> <span class="p">(</span><span class="nn">List</span><span class="p">.</span><span class="n">is_empty</span> <span class="n">lstr</span><span class="p">)</span> <span class="k">then</span> 
    <span class="o">(-</span><span class="mi">1</span><span class="p">,</span> <span class="o">[(</span><span class="mi">0</span><span class="o">,-</span><span class="mi">1</span><span class="o">)])</span> <span class="c">(* empty string *)</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nn">String</span><span class="p">.</span><span class="n">is_empty</span> <span class="n">str</span><span class="p">)</span> <span class="k">then</span>
    <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">[(-</span><span class="mi">1</span><span class="o">,-</span><span class="mi">1</span><span class="o">)])</span>
  <span class="k">else</span>
    <span class="k">begin</span>
     <span class="c">(* find the first occurrence of substring containing the strings in lstr *)</span>
     <span class="k">let</span> <span class="n">substr_index</span> <span class="p">=</span> <span class="n">sub_lstr</span> <span class="n">str</span> <span class="n">lstr</span> <span class="k">in</span> 
     <span class="k">if</span> <span class="p">(</span><span class="n">substr_index</span> <span class="p">=</span> <span class="o">(-</span><span class="mi">1</span><span class="o">,-</span><span class="mi">1</span><span class="o">))</span> <span class="k">then</span> 
       <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">[(-</span><span class="mi">1</span><span class="o">,-</span><span class="mi">1</span><span class="o">)])</span>
     <span class="k">else</span> 
       <span class="k">begin</span>
         <span class="k">let</span> <span class="n">fi</span><span class="p">,</span> <span class="n">li</span> <span class="p">=</span> <span class="n">substr_index</span> <span class="k">in</span> 
         <span class="k">let</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">lshortest_substr</span><span class="p">)</span> <span class="p">=</span> <span class="n">find_shortest_substrings_aux</span> <span class="mi">1</span> <span class="p">[</span><span class="n">substr_index</span><span class="p">]</span> <span class="p">(</span><span class="nn">String</span><span class="p">.</span><span class="n">sub</span> <span class="n">str</span> <span class="p">(</span><span class="n">fi</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nn">String</span><span class="p">.</span><span class="n">length</span> <span class="n">str</span> <span class="p">-</span> <span class="p">(</span><span class="n">fi</span> <span class="o">+</span> <span class="mi">1</span><span class="o">)))</span> <span class="n">lstr</span> <span class="p">(</span><span class="n">fi</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">in</span> 
         <span class="c">(* remove all duplicates before return *)</span>
         <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nn">List</span><span class="p">.</span><span class="n">dedup</span> <span class="p">~</span><span class="n">compare</span><span class="o">:(</span><span class="n">index_compare</span><span class="p">)</span> <span class="n">lshortest_substr</span><span class="p">)</span>
       <span class="k">end</span>
    <span class="k">end</span>		
</code></pre>
</div>

</span>

        

        
		
        
        <div class="tags">
          <small>
          <i class="fa fa-tags"></i>
            substring, string, algorithm, OCaml, programming
          </small>
        </div>
        

      </div>

      <!--
      <div class="content-panel feedback">
        I <i class="fa fa-heart"></i> feedback.<br />
        Let me know what you think of this article on twitter <a href="http://www.twitter.com/channgo2203">@channgo2203</a> or leave a comment below!
      </div>
      -->

      
      <div class="content-panel comments">
        <div id="disqus_thread">
          <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
          <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        </div>
      </div>
      

      

    </div>

  </div>

</div>


<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
function disqus_config() { this.experiment.enable_scroll_container = true; }
var disqus_shortname = "channgo"; // required: replace example with your forum shortname
/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
  (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>


      </div>
    </div>

    <div class="footer clearfix">
  <div class="col-md-6">
    Created by <a href="mailto:chan.ngo2203@gmail.com">Van Chan Ngo</a>
  </div>
  <div class="col-md-6">
    &lt;/&gt; on <a href="https://github.com/channgo2203">Github</a> &nbsp;<i class="fa fa-github-alt"></i>
  </div>
</div>

<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
<script src="/js/jquery.mmenu.min.all.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script type="text/javascript">
   $(document).ready(function() {
      $("#my-menu").mmenu().on( "closed.mm", function() {
            $(".menu-button").show();
         });
      $(".menu-button").click(function() {
        $(".menu-button").hide();
        $("#my-menu").trigger("open.mm");
      });
   });
</script>




<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-89119753-1']);
          _gaq.push(['_trackPageview']);
  (function () {
      var ga = document.createElement('script');
      ga.type = 'text/javascript';
      ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';

      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(ga, s);
  })();
</script>



    </body>
</html>
