<!DOCTYPE html>
<html lang="en">

<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MFGCXMJ');</script>
<!-- End Google Tag Manager -->
  
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Probabilistic Functional Programs</title>
  <meta name="description" content="An example of probabilistic functional program.">

  <!-- CSS files -->
  <link rel="stylesheet" href="http://localhost:4000/css/font-awesome.min.css">
  <link rel="stylesheet" href="http://localhost:4000/css/main.css">

  <link rel="canonical" href="http://localhost:4000/articles/2017-02/probfind">
  <link rel="alternate" type="application/rss+xml" title="Van Chan Ngo" href="http://localhost:4000/feed.xml" />

  <!-- Icons -->
  <!-- 16x16 -->
  <link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
  <!-- 32x32 -->
  <link rel="shortcut icon" href="http://localhost:4000/favicon.png">
</head>


<body>
  <div class="row">
    <div class="col s12 m3">
      <div class="table cover">
        

<div class="cover-card table-cell table-middle">
  
  <img src="http://localhost:4000/img/avatar.jpg" alt="" class="avatar">
  
  <a href="http://localhost:4000/" class="author_name">Van Chan Ngo</a>
  <span class="author_job">Computer Scientist and Software Engineer</span>
  <span class="author_bio mbm">Research interests are in formal methods, programming languages, compilers, and language-based security. I am a member of the Principles of Programming Group, School of Computer Science, Carnegie Mellon University.</span>
  <nav class="nav">
    <ul class="nav-list">
      <li class="nav-item">
        <a href="http://localhost:4000/about.html">About</a>
        <span>/</span>
      </li>
      <li class="nav-item">
        <a href="http://localhost:4000/research.html">Research</a>
        <span>/</span>
      </li>
       <li class="nav-item">
        <a href="http://localhost:4000/publications.html">Publications</a>
      </li>
    </ul>
    <ul class="nav-list">
      <li class="nav-item">
        <a href="http://localhost:4000/talks.html">Talks</a>
        <span>/</span>
      </li>
      <li class="nav-item">
        <a href="http://localhost:4000/notes/">Notes</a>
        <span>/</span>
      </li>
      <li class="nav-item">
        <a href="http://localhost:4000/pdfs/cv.pdf" target="_blank">CV</a>
        <span>/</span>
      </li>
      <li class="nav-item">
        <a href="http://localhost:4000/categories/">Categories</a>
      </li>
    </ul>
    <ul class="nav-list">
      <li class="nav-item">
        <a href="http://localhost:4000/tags/">Tags</a>
      </li>
    </ul>
  </nav>
  <script type="text/javascript">
  // based on http://stackoverflow.com/a/10300743/280842
  function gen_mail_to_link(hs, subject) {
    var lhs,rhs;
    var p = hs.split('@');
    lhs = p[0];
    rhs = p[1];
    document.write("<a class=\"social-link-item\" target=\"_blank\" href=\"mailto");
    document.write(":" + lhs + "@");
    document.write(rhs + "?subject=" + subject + "\"><i class=\"fa fa-fw fa-envelope\"></i><\/a>");
  }
</script>
<div class="social-links">
  <ul>
    
      <li>
      <script>gen_mail_to_link('chan.ngo2203@gmail.com', 'Hello from website');</script>
      </li>
    
    
    
    
    <li><a href="http://linkedin.com/in/channgo2203" class="social-link-item" target="_blank"><i class="fa fa-fw fa-linkedin"></i></a></li>
    
    
    
    
    <li><a href="http://github.com/channgo2203" class="social-link-item" target="_blank"><i class="fa fa-fw fa-github"></i></a></li>
    
    
    
    
    
    
    
    
    
    
    
    
    
  </ul>
</div>

  <div class="social-links">
    <span class="author_bio mbm">Do one thing, and do it well.</span>
    <span class="author_bio mbm">-- Unix philosophy</span>
  </div>
</div>

      </div>
    </div>
    <div class="col s12 m9">
      <div class="post-listing">
        <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<a class="author_job" href= "http://localhost:4000/" >
  Home
</a>



<div id="post">
  <header class="post-header">
    <h1 title="Probabilistic Functional Programs">Probabilistic Functional Programs</h1>
    <span class="post-meta">
      <span class="post-date">
        22 FEB 2017
      </span>
      •
      <span class="read-time" title="Estimated read time">
  
  
    5 mins read
  
</span>

    </span>

  </header>

  <article class="post-content">
    <p>In this post, I would like to start a topic about probabilistic programming in OCaml.</p>

<h2 id="probabilistic-programming">Probabilistic Programming</h2>

<p>Probabilistic programing languages are standard programming languages like C, Java, or ML, with two additional constructs:</p>

<ul>
  <li>
    <p>The sampling construct for drawing a value at random from probability distributions</p>
  </li>
  <li>
    <p>The probabilistic branching construct for controlling the flow in a program through observations.</p>
  </li>
</ul>

<p>The applications of probabilistic programming is wide, for instance, probabilistic programs are used in machine learning and robotics to describe distribution functions that are analyzed using Bayesian inference. In security, probabilistic programming has played a central role in cryptography, i.e., probabilistic security guarantees and probabilistic encryption. Probabilistic programs are also used to model the performance and reliability properties of a variety of systems, in which the uncertainties can come from the reliability of components (hardwares or softwares), the data from sensors, the reliability of the communication channels in the systems (e.g., the aircraft’s control systems).</p>

<p>This raises the question of how to analyze and verify that a system exhibiting probabilistic behavior satisfies a certain property. There is a rapidly growing trend in research on probabilistic programs which focuses on many aspects such as static analysis, program compilation, and program verification. To mention a few, the extension the framework of abstract interpretation to probabilistic programs, the development of a calculus for obtaining upper bounds on the expected value of run-time for probabilistic programs, and the developments of probabilistic and statistic model checking techniques for verifying probabilistic temporal properties of probabilistic and timed systems.</p>

<h2 id="example">Example</h2>

<p>The following implements a simple example of probabilistic program for finding a given value in a list of integer values. The fist function <code class="highlighter-rouge">find</code> represents the standard program, e.g., without probability. It is easy to see that in the worst-case, the variable <code class="highlighter-rouge">acc</code> (initialized to 0) will have the value as the length of the input list <code class="highlighter-rouge">l</code>.</p>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="k">rec</span> <span class="n">find</span> <span class="n">a</span> <span class="n">l</span> <span class="n">acc</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">l</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="bp">false</span><span class="o">,</span> <span class="n">acc</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">x</span><span class="o">::</span><span class="n">xs</span> <span class="o">-&gt;</span> 
    <span class="k">if</span> <span class="n">a</span> <span class="o">=</span> <span class="n">x</span> <span class="k">then</span> 
      <span class="p">(</span><span class="bp">true</span><span class="o">,</span><span class="p">(</span><span class="n">acc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> 
    <span class="k">else</span> 
      <span class="n">find</span> <span class="n">a</span> <span class="n">xs</span> <span class="p">(</span><span class="n">acc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);;</span> 
</code></pre></div></div>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="k">rec</span> <span class="n">pfind</span> <span class="n">a</span> <span class="n">l</span> <span class="n">acc</span> <span class="o">=</span>
  <span class="k">match</span> <span class="n">l</span> <span class="k">with</span>
  <span class="o">|</span> <span class="bp">[]</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="bp">false</span><span class="o">,</span> <span class="n">acc</span><span class="p">)</span>
  <span class="o">|</span> <span class="n">x</span><span class="o">::</span><span class="n">xs</span> <span class="k">as</span> <span class="n">l</span> <span class="o">-&gt;</span> <span class="k">let</span> <span class="n">c</span> <span class="o">=</span> <span class="nn">Random</span><span class="p">.</span><span class="n">int</span> <span class="mi">2</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">then</span> 
      <span class="n">pfind</span> <span class="n">a</span> <span class="n">l</span> <span class="p">(</span><span class="n">acc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> 
    <span class="k">else</span> 
      <span class="p">(</span><span class="k">if</span> <span class="n">a</span> <span class="o">=</span> <span class="n">x</span> <span class="k">then</span> 
         <span class="p">(</span><span class="bp">true</span><span class="o">,</span><span class="p">(</span><span class="n">acc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> 
       <span class="k">else</span> 
         <span class="n">pfind</span> <span class="n">a</span> <span class="n">xs</span> <span class="p">(</span><span class="n">acc</span> <span class="o">+</span> <span class="mi">1</span><span class="p">));;</span> 
</code></pre></div></div>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="n">test</span> <span class="n">n</span> <span class="n">f</span> <span class="n">a</span> <span class="n">l</span> <span class="o">=</span>
  <span class="k">let</span> <span class="n">res</span> <span class="o">=</span> <span class="n">ref</span> <span class="bp">[]</span> <span class="k">in</span>
  <span class="k">for</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">to</span> <span class="n">n</span> <span class="k">do</span>
    <span class="k">let</span> <span class="p">(</span><span class="n">found</span><span class="o">,</span><span class="n">cost</span><span class="p">)</span> <span class="o">=</span> <span class="n">f</span> <span class="n">a</span> <span class="n">l</span> <span class="mi">0</span> <span class="k">in</span>
	<span class="n">res</span> <span class="o">:=</span> <span class="n">cost</span><span class="o">::</span><span class="p">(</span><span class="o">!</span><span class="n">res</span><span class="p">)</span>
  <span class="k">done</span><span class="p">;</span> 
  <span class="k">let</span> <span class="n">sum</span> <span class="o">=</span> <span class="nn">List</span><span class="p">.</span><span class="n">fold_left</span> <span class="p">(</span><span class="k">fun</span> <span class="n">s</span> <span class="n">x</span> <span class="o">-&gt;</span> <span class="n">s</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span> <span class="mi">0</span> <span class="o">!</span><span class="n">res</span> <span class="k">in</span> 
  <span class="p">(</span><span class="n">float_of_int</span> <span class="n">sum</span><span class="p">)</span> <span class="o">/.</span> <span class="p">(</span><span class="n">float_of_int</span> <span class="n">n</span><span class="p">);;</span>
</code></pre></div></div>

<p>In the second function <code class="highlighter-rouge">pfind</code>, the integer value <code class="highlighter-rouge">c</code> is sampled from a uniform distribution from 0 (inclusive) to 2 (exclusive). In other words, <code class="highlighter-rouge">c</code> is <code class="highlighter-rouge">0</code> with probability <code class="highlighter-rouge">0.5</code> and is <code class="highlighter-rouge">1</code> with probability <code class="highlighter-rouge">1 - 0.5 = 0.5</code>. A a result, with probability <code class="highlighter-rouge">0.5</code>, the recursive call on the tail of the list is skipped and with the same probability the recursion is called on the tail of the list.</p>

<p>We can see that the recursion can be infinite, e.g., the number of times such that <code class="highlighter-rouge">c</code> is <code class="highlighter-rouge">0</code> is infinite. However, we can calculate that the probability that the number of times such that <code class="highlighter-rouge">c</code> is <code class="highlighter-rouge">0</code> is infinite, is <script type="math/tex">\frac{1}{2^n}</script> with <script type="math/tex">n \rightarrow +\infty</script> which is <code class="highlighter-rouge">0</code>. It is said that <code class="highlighter-rouge">pfind</code> is <strong>almost surely terminated</strong>.</p>

<p>The question is what is the behavior of <code class="highlighter-rouge">pfind</code>. For example,</p>

<blockquote>
  <p>what is the <strong>expected value</strong> of the variable <code class="highlighter-rouge">acc</code>?</p>
</blockquote>

<p>For this simple program, we can compute manually that this expected value is <code class="highlighter-rouge">2.|l|</code>, where <code class="highlighter-rouge">|l|</code> is the number of elements in the list in the worst-case. My on-going work is to automatically and statically infer a symbolic upper bound on this expected value. The following are the average values of <code class="highlighter-rouge">acc</code> when we run <code class="highlighter-rouge">find</code> and <code class="highlighter-rouge">pfind</code> <code class="highlighter-rouge">10000000</code> times.</p>

<div class="language-ocaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">#</span> <span class="n">test</span> <span class="mi">10000000</span> <span class="n">find</span> <span class="mi">10</span> <span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">2</span><span class="p">;</span><span class="mi">3</span><span class="p">;</span><span class="mi">4</span><span class="p">;</span><span class="mi">5</span><span class="p">;</span><span class="mi">6</span><span class="p">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">float</span> <span class="o">=</span> <span class="mi">7</span><span class="o">.</span>
<span class="o">#</span> <span class="n">test</span> <span class="mi">10000000</span> <span class="n">pfind</span> <span class="mi">10</span> <span class="p">[</span><span class="mi">0</span><span class="p">;</span><span class="mi">1</span><span class="p">;</span><span class="mi">2</span><span class="p">;</span><span class="mi">3</span><span class="p">;</span><span class="mi">4</span><span class="p">;</span><span class="mi">5</span><span class="p">;</span><span class="mi">6</span><span class="p">];;</span>
<span class="o">-</span> <span class="o">:</span> <span class="kt">float</span> <span class="o">=</span> <span class="mi">13</span><span class="o">.</span><span class="mi">998363</span>
</code></pre></div></div>

  </article>
</div>
<!--
<div class="share-buttons">
  <h6>Share on: </h6>
  <ul>
    <li>
      <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/articles/2017-02/probfind" class="twitter btn" title="Share on Twitter"><i class="fa fa-twitter"></i><span> Twitter</span></a>
    </li>
    <li>
      <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/articles/2017-02/probfind" class="facebook btn" title="Share on Facebook"><i class="fa fa-facebook"></i><span> Facebook</span></a>
    </li>
    <li>
      <a href="https://plus.google.com/share?url=http://localhost:4000/articles/2017-02/probfind" class="google-plus btn" title="Share on Google Plus"><i class="fa fa-google-plus"></i><span> Google+</span></a>
    </li>
    <li>
      <a href="https://news.ycombinator.com/submitlink?u=http://localhost:4000/articles/2017-02/probfind" class="hacker-news btn" title="Share on Hacker News"><i class="fa fa-hacker-news"></i><span> Hacker News</span></a>
    </li>
    <li>
      <a href="https://www.reddit.com/submit?url=http://localhost:4000/articles/2017-02/probfind" class="reddit btn" title="Share on Reddit"><i class="fa fa-reddit"></i><span> Reddit</span></a>
    </li>
  </ul>
</div>-->


<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'channgo';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>



        <footer>
  &copy; 2018 Van Chan Ngo. Powered by <a href="http://jekyllrb.com/">Jekyll</a>, <a href="http://github.com/renyuanz/leonids/">leonids theme</a>
</footer>

      </div>
    </div>
  </div>
  <script type="text/javascript" src="http://localhost:4000/js/jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="http://localhost:4000/js/main.js"></script>

<!-- Asynchronous Google Analytics snippet -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-89119753-1', 'auto');
  ga('send', 'pageview');
</script>


</body>

<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MFGCXMJ"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
  
</html>
